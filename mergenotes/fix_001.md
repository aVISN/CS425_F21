# notes on branch main-fix_001:

1. Lets start with the 404 error for the /static/home-stye.css request reported by the Django dev server: 

- we have configured nginx to serve static files; to do so, static files are collected in a single directory

- this is done by running the django project admin tool: 
	```
	cd /srv/apps
	source venv/bin/activate
	cd /visn
	./manage.py collectstatic
	```
- FILES ARE **NOT** ADDED TO THE /srv/apps/visn/static directory MANUALLY!
	- or at least it didn't work to do so with the home-style.css file...

first thing to fix: 404 error reported by django dev server for GET /static/home-style.css requests being returned for all pages, localhost:8000/, .../login, .../register .../about .../dashboard...

We can see that Django is looking for a file named home-style.css in the /static directory. 

One of the things we are doing is serving static files directly with Nginx. They are collected automatically with the use of a managment script if they are stored where Django looks by defaultl. So we first want to create a static directory in our project's pages app. Django will look for static files there, similarly to how Django finds templates inside pages/templates/. Because of how the static file finder works, we also want to create a directory within the app's static directory that has the same name as the app, such that we end up with: 
/srv/apps/visn/pages/static/pages/home-style.css
it looks like there is a /srv/apps/visn/static/home-style.css

Django’s STATICFILES_FINDERS setting contains a list of finders that know how to discover static files from various sources. One of the defaults is AppDirectoriesFinder which looks for a “static” subdirectory in each of the INSTALLED_APPS, like our pages app. 

So within the project's pages app, /srv/apps/visn/pages, I'm going to create a directory called static. Within the static directory, because of how the AppDirectoriesFinder staticfile finder works, I am going to create a directory called pages, so we've got /srv/apps/visn/pages/static/pages/ and I am saving the home-style.css file there so that we end up with /srv/apps/visn/pages/static/pages/home-style.css. 

Why so many directories? From the Django docs: "Just like templates, we might be able to get away with putting our static files directly in polls/static (rather than creating another polls subdirectory), but it would actually be a bad idea. Django will choose the first static file it finds whose name matches, and if you had a static file with the same name in a different application, Django would be unable to distinguish between them. We need to be able to point Django at the right one, and the best way to ensure this is by namespacing them. That is, by putting those static files inside another directory named for the application itself."

Now, because of how the AppDirectoriesFinder staticfile finder works, although the file is at /srv/apps/visn/pages/static/pages/home-style.css we can refer to this static file in Django as pages/home-style.css

Now when we run ./manage.py collectstatic, the home-style.css page is found and added to the /srv/apps/visn/static directory by the script. 

We can also use the management script to check where Django is searching for static pages now: 
./manage.py findstatic pages/home-style.css --verbosity 3 
which shows that the file is being found and that the /srv/apps/visn/pages/static directory is being checked now since running the collectstatic command.

I am removing the home-style.css file from /srv/aps/visn/static, it is now found further down in /srv/apps/visn/static/pages/home-style.css -- but this instance was collected by the django management script, the only thing we needed to do was create the static directory within the pages app, and for namespace purposes and default search style of management script, created subdirectory with same name as app: /srv/apps/visn/pages/static/pages/, put our .css there, and then run ./manage.py collectstatic which looks within app subdirectories for static files to collect, and then collects them into the project's static directory /srv/apps/visn/static/pages so that nginx can serve them directly. 

Now if we test with devserver, we can see that we still get a 404 error because we need to update the path that the pages are looking for the file at, should be /static/pages/home-style.css because static base path is relative to project directory, /srv/apps/visn, but it is reporting an error for /static/home-style.css

We have a clue that it must be in the base.html template since every page is returning the 404 error. 
if we look in the template we see `<link href="{% static 'home-style.css' %}" rel="stylesheet"/>` lets update this to `{% static 'pages/home-style.css' %}`

Now when we run the dev server and access localhost:8000 we no longer see a 404 error reported in the terminal for the localhost:8000, localhost:8000/login, localhost:8000/register, or localhost:8000/about pages. But when we visit the dashboard page by using the "Home" link fromt the main page, we get the same old error and there is still no formatting is being applied. This is because inheritance was removed from the dashboard template. We need to make the same path correction as before to the {% static 'home-style.css' %} in the dashboard.html template. 

And now when we run the dev server, we don't get any 404 error when visiting the dashboard page at localhost:8000/dashboard and it has formatting applied!!!

---


